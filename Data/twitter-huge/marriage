import ijson
import json

marital_data = []
count = 0
keywords = ["marriage", "wedding", "spouse", "bride", "groom", "marital","marry"]

with open('twitter-huge.json', 'r', encoding='utf-8') as f:
    parser = ijson.parse(f)
    for prefix, event, value in parser:
        if prefix.endswith('.tokens') and event == 'string':
            tokens = value
            if any(keyword in value.lower() for keyword in keywords):
                marital_data.append(value)
                count += 1

    print("total count:", count)

json_data = json.dumps(marital_data, indent=2)

with open("marriage_twitters.json", "w") as f:
    f.write(json_data)
